h1 {
    font-size: 1.8em;
}

/* Mobile Navigation */
nav ul {
    display: none;
    flex-direction: column;
    align-items: center;
    padding-top: 15px;
}

nav ul.active {
    display: flex;
}

nav ul li {
    margin: 10px 0;
    width: 100%;
    text-align: center;
}

.mobile-nav-toggle {
    display: block;
    position: absolute;
    right: 20px;
    top: 15px;
}

.gallery {
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
}

.user-controls {
    flex-direction: column;
    gap: 15px;
    text-align: center;
}

.logout-btn {
    width: 100%;
    justify-content: center;
}

.edit-form {
    padding: 20px;
}

.lightbox-content {
    max-width: 95%;
}
}
</style>
</head>
<body>
<!-- Loading Overlay -->
<div class="loading-overlay" id="loadingOverlay">
<div class="loading-spinner"></div>
</div>

<div class="theme-switch">
<button id="darkModeToggle"><i class="fas fa-moon"></i></button>
</div>

<!-- Login Forms -->
<div class="login-container" id="loginContainer">
<!-- Email Login Form -->
<div class="login-form" id="emailLoginForm" style="border-left: none;">
<h2 style="border-left: none; position: relative;">Login with Email</h2>
<div class="form-group" id="emailFormGroup">
    <label for="email">Email:</label>
    <input type="email" id="email" placeholder="Enter your email">
    <i class="fas fa-exclamation-circle validation-icon error"></i>
    <i class="fas fa-check-circle validation-icon success"></i>
    <div class="error" id="emailError">Please enter a valid email address</div>
</div>
<div class="form-group" id="passwordFormGroup">
    <label for="password">Password:</label>
    <input type="password" id="password" placeholder="Enter your password">
    <i class="fas fa-exclamation-circle validation-icon error"></i>
    <i class="fas fa-check-circle validation-icon success"></i>
    <div class="error" id="passwordError">Please enter your password</div>
</div>
<button class="btn" id="emailLoginBtn">Login</button>
<button class="btn" id="emailSignupBtn" style="margin-top: 10px; background-color: var(--secondary);">Sign Up</button>
<div class="separator"><span>OR</span></div>
<button class="btn github-login" id="googleLoginBtn">
    <i class="fab fa-google"></i> Login with Google
</button>
<div class="login-message" id="emailLoginMessage"></div>
</div>
</div>

<div class="container" id="mainContent" style="display:none;">
<!-- User Controls -->
<div class="user-controls">
<div>
    <span class="current-user" id="currentUser"><i class="fas fa-user-circle"></i> Guest</span>
    <span class="admin-badge hidden" id="adminBadge">Admin</span>
</div>
<button class="logout-btn" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</button>
</div>

<!-- Admin Panel -->
<div class="admin-panel hidden" id="adminPanel">
<h3><i class="fas fa-shield-alt"></i> Admin Panel</h3>
<p>Welcome, Admin! You have full access to edit and manage the website content. Click the edit button on any section to make changes.</p>
</div>

<header>
<img src="Picture.png" alt="Profile Picture" class="profile-pic" id="profilePic">
<h1 id="headerName">Charvi</h1>
<p class="tagline" id="tagline">Welcome To Charvi's Personal Site</p>
<button class="edit-btn" id="editHeader"><i class="fas fa-edit"></i> Edit</button>
</header>

<nav>
<button class="mobile-nav-toggle" id="mobileNavToggle">
    <i class="fas fa-bars"></i>
</button>
<ul id="navMenu">
    <li><a href="#about"><i class="fas fa-user"></i> About Me</a></li>
    <li><a href="#interests"><i class="fas fa-heart"></i> Interests</a></li>
    <li><a href="#gallery"><i class="fas fa-images"></i> Gallery</a></li>
    <li><a href="#contact"><i class="fas fa-envelope"></i> Contact</a></li>
</ul>
</nav>

<section id="about">
<h2>About Me</h2>
<div id="aboutContent">
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam vitae fermentum felis, vel auctor nisl. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Donec at ipsum vitae nunc vehicula faucibus ac eget tortor.</p>
    <p>Suspendisse potenti. Mauris accumsan arcu sed quam sodales, non dictum eros euismod. Proin condimentum velit id augue blandit, eu tincidunt nulla iaculis. Sed id sem vel velit interdum vehicula sit amet nec libero.</p>
</div>
<button class="edit-btn" id="editAbout"><i class="fas fa-edit"></i> Edit</button>
</section>

<section id="interests">
<h2>My Interests</h2>
<p>These are some of the things I'm passionate about:</p>
<ul id="interestsList" style="margin-left:20px; margin-top:10px;">
    <li>Cooking</li>
    <li>Interest 2</li>
    <li>Interest 3</li>
    <li>Interest 4</li>
</ul>
<button class="edit-btn" id="editInterests"><i class="fas fa-edit"></i> Edit</button>
</section>

<section id="gallery">
<h2>Gallery</h2>
<p>Some of my favorite moments and memories:</p>
<div id="galleryItems" class="gallery">
    <!-- Gallery items will be generated by JavaScript -->
</div>
<button class="edit-btn" id="editGallery"><i class="fas fa-edit"></i> Edit</button>
</section>

<section id="contact">
<h2>Get In Touch</h2>
<p>Feel free to reach out to me through any of these platforms:</p>
<div id="contactLinks" class="social-links">
    <a href="mailto:astikspandey@gmail.com"><i class="fas fa-envelope"></i> Email</a>
    <a href="#"><i class="fas fa-phone"></i> Phone</a>
    <a href="#"><i class="fab fa-instagram"></i> Instagram</a>
    <a href="#"><i class="fab fa-linkedin"></i> LinkedIn</a>
</div>
<button class="edit-btn" id="editContact"><i class="fas fa-edit"></i> Edit</button>
</section>

<footer>
<p>&copy; 2025 Charvi's Personal Website. All rights reserved.</p>
</footer>
</div>

<!-- Lightbox for Gallery -->
<div class="lightbox" id="lightbox">
<span class="lightbox-close" id="lightboxClose"><i class="fas fa-times"></i></span>
<div class="lightbox-content">
<img id="lightboxImage" src="" alt="Gallery Image">
<div class="lightbox-caption" id="lightboxCaption"></div>
</div>
<div class="lightbox-nav">
<span class="lightbox-prev" id="lightboxPrev"><i class="fas fa-chevron-left"></i></span>
<span class="lightbox-next" id="lightboxNext"><i class="fas fa-chevron-right"></i></span>
</div>
</div>

<!-- Edit Modals -->
<div class="edit-modal" id="headerEditModal">
<div class="edit-form">
<h3><i class="fas fa-heading"></i> Edit Header</h3>
<div class="form-group">
    <label for="editTagline">Tagline:</label>
    <input type="text" id="editTagline" placeholder="Enter tagline">
</div>
<div class="form-group">
    <label for="editProfilePic">Profile Picture:</label>
    <div class="file-input-container">
        <label class="file-input-label">
            <i class="fas fa-upload"></i> Choose Image
            <input type="file" id="profilePicUpload" class="file-input" accept="image/*">
        </label>
        <div class="file-name" id="profilePicFileName">No file chosen</div>
    </div>
    <p>OR enter a URL:</p>
    <input type="text" id="editProfilePic" placeholder="Enter profile picture URL">
</div>
<div class="btn-container">
    <button class="btn" id="saveHeaderBtn"><i class="fas fa-save"></i> Save Changes</button>
    <button class="btn cancel-btn" id="cancelHeaderBtn"><i class="fas fa-times"></i> Cancel</button>
</div>
</div>
</div>

<div class="edit-modal" id="aboutEditModal">
<div class="edit-form">
<h3><i class="fas fa-user"></i> Edit About Me</h3>
<textarea id="editAboutContent" placeholder="Enter about me content"></textarea>
<div class="btn-container">
    <button class="btn" id="saveAboutBtn"><i class="fas fa-save"></i> Save Changes</button>
    <button class="btn cancel-btn" id="cancelAboutBtn"><i class="fas fa-times"></i> Cancel</button>
</div>
</div>
</div>

<div class="edit-modal" id="interestsEditModal">
<div class="edit-form">
<h3><i class="fas fa-heart"></i> Edit Interests</h3>
<div id="interestsEditList"></div>
<button class="btn" id="addInterestBtn" style="background-color:var(--secondary); width:auto; margin-top:10px; padding:8px 15px; font-size:14px;">
    <i class="fas fa-plus"></i> Add Interest
</button>
<div class="btn-container" style="margin-top:20px;">
    <button class="btn" id="saveInterestsBtn"><i class="fas fa-save"></i> Save Changes</button>
    <button class="btn cancel-btn" id="cancelInterestsBtn"><i class="fas fa-times"></i> Cancel</button>
</div>
</div>
</div>

<div class="edit-modal" id="galleryEditModal">
<div class="edit-form">
<h3><i class="fas fa-images"></i> Edit Gallery</h3>
<p>Upload images or provide URLs for gallery items:</p>
<div id="galleryEditItems"></div>
<button class="btn" id="addGalleryItemBtn" style="background-color:var(--secondary); width:auto; margin-top:10px; padding:8px 15px; font-size:14px;">
    <i class="fas fa-plus"></i> Add Gallery Item
</button>
<div class="btn-container" style="margin-top:20px;">
    <button class="btn" id="saveGalleryBtn"><i class="fas fa-save"></i> Save Changes</button>
    <button class="btn cancel-btn" id="cancelGalleryBtn"><i class="fas fa-times"></i> Cancel</button>
</div>
</div>
</div>

<div class="edit-modal" id="contactEditModal">
<div class="edit-form">
<h3><i class="fas fa-address-book"></i> Edit Contact Links</h3>
<div class="form-group">
    <label for="editEmail">Email:</label>
    <input type="email" id="editEmail" placeholder="Enter email address">
</div>
<div class="form-group">
    <label for="editPhone">Phone:</label>
    <input type="text" id="editPhone" placeholder="Enter phone number">
</div>
<div class="form-group">
    <label for="editInstagram">Instagram:</label>
    <input type="text" id="editInstagram" placeholder="Enter Instagram profile URL">
</div>
<div class="form-group">
    <label for="editLinkedIn">LinkedIn:</label>
    <input type="text" id="editLinkedIn" placeholder="Enter LinkedIn profile URL">
</div>
<div class="btn-container">
    <button class="btn" id="saveContactBtn"><i class="fas fa-save"></i> Save Changes</button>
    <button class="btn cancel-btn" id="cancelContactBtn"><i class="fas fa-times"></i> Cancel</button>
</div>
</div>
</div>

<!-- Save Notification -->
<div id="saveNotification">
<i class="fas fa-check-circle"></i> Changes saved successfully!
</div>

<script>
// Initialize Firebase with your config
// REPLACE WITH YOUR ACTUAL FIREBASE CONFIG
const firebaseConfig = {

apiKey: "AIzaSyAoJVelk7rm-RnAWZJ2agypDCysBR_AQ0s",

authDomain: "charviwebsite-b90d9.firebaseapp.com",

projectId: "charviwebsite-b90d9",

storageBucket: "charviwebsite-b90d9.firebasestorage.app",

messagingSenderId: "1023163620715",

appId: "1:1023163620715:web:da0df2489e9d784bbe802e",

measurementId: "G-TZQTXB275K"

};



// Initialize Firebase
firebase.initializeApp(firebaseConfig);

// Get Firebase services
const auth = firebase.auth();
const db = firebase.firestore();
const storage = firebase.storage();

// Global variables
let currentUser = null;
let isAdmin = false;
let currentGalleryIndex = 0;
let darkModeEnabled = false;
let websiteContent = null;

// Default website content
const defaultWebsiteContent = {
header: {tagline: "Welcome To Charvi's Personal Site", profilePic: "Picture.png"},
about: "<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam vitae fermentum felis, vel auctor nisl. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Donec at ipsum vitae nunc vehicula faucibus ac eget tortor.</p><p>Suspendisse potenti. Mauris accumsan arcu sed quam sodales, non dictum eros euismod. Proin condimentum velit id augue blandit, eu tincidunt nulla iaculis. Sed id sem vel velit interdum vehicula sit amet nec libero.</p>",
interests: ["Cooking", "Reading", "Photography", "Traveling"],
gallery: [
{url:"", caption:"Gallery Item 1"},
{url:"", caption:"Gallery Item 2"},
{url:"", caption:"Gallery Item 3"},
{url:"", caption:"Gallery Item 4"},
{url:"", caption:"Gallery Item 5"},
{url:"", caption:"Gallery Item 6"}
],
contact: {email:"astikspandey@gmail.com", phone:"", instagram:"", linkedin:""}
};

// Helper function to get element by ID
function getElement(id) {
return document.getElementById(id);
}

// Show/hide loading overlay
function showLoading() {
getElement("loadingOverlay").style.display = "flex";
}

function hideLoading() {
getElement("loadingOverlay").style.display = "none";
}

// Wait for the DOM to be fully loaded
window.onload = function() {
// Initialize the website
initializeWebsite();
};

// Initialize website
function initializeWebsite() {
try {
console.log("Initializing website...");
showLoading();

// Set up authentication state listener
auth.onAuthStateChanged(function(user) {
    if (user) {
        // User is signed in
        handleSignedInUser(user);
    } else {
        // No user is signed in
        hideLoading();
        getElement("loginContainer").style.display = "flex";
        getElement("mainContent").style.display = "none";
    }
});

// Set up form validation
setupValidation();

// Set up event listeners
attachEventListeners();

console.log("Website initialization complete!");
} catch (error) {
console.error("Error during website initialization:", error);
hideLoading();
}
}

// Handle signed in user
async function handleSignedInUser(user) {
try {
currentUser = user;

// Check if user is admin
const userDoc = await db.collection("users").doc(user.uid).get();
if (userDoc.exists) {
    isAdmin = userDoc.data().isAdmin || false;
} else {
    // Create user document if it doesn't exist
    await db.collection("users").doc(user.uid).set({
        email: user.email,
        displayName: user.displayName || user.email,
        isAdmin: user.email === "astikspandey@gmail.com" // Make the website creator admin by default
    });
    isAdmin = user.email === "astikspandey@gmail.com";
}

// Load content
await loadContent();

// Render content
renderContent();

// Set up scroll events
setupScrollEvents();

// Update UI
getElement("currentUser").innerHTML = `<i class="fas fa-user-circle"></i> ${user.displayName || user.email}`;

if (isAdmin) {
    getElement("adminBadge").classList.remove("hidden");
    getElement("adminPanel").classList.remove("hidden");
    document.querySelectorAll(".edit-btn").forEach(btn => btn.style.display = "block");
} else {
    getElement("adminBadge").classList.add("hidden");
    getElement("adminPanel").classList.add("hidden");
    document.querySelectorAll(".edit-btn").forEach(btn => btn.style.display = "none");
}

// Show main content
getElement("loginContainer").style.display = "none";
getElement("mainContent").style.display = "block";

// Hide loading
hideLoading();

console.log("User signed in:", user.email, "Admin:", isAdmin);
} catch (error) {
console.error("Error handling signed in user:", error);
hideLoading();
}
}

// Attach all event listeners
function attachEventListeners() {
// Auth listeners
getElement("emailLoginBtn").onclick = handleEmailLogin;
getElement("emailSignupBtn").onclick = handleEmailSignup;
getElement("googleLoginBtn").onclick = handleGoogleLogin;
getElement("logoutBtn").onclick = handleLogout;

// Dark mode toggle
getElement("darkModeToggle").onclick = toggleDarkMode;

// Mobile navigation
getElement("mobileNavToggle").onclick = toggleMobileNav;

// Setup other event listeners
setupNavLinks();
setupLightboxControls();
setupFileUpload();
setupEditButtons();

console.log("Event listeners attached successfully");
}

// Authentication handlers
function handleEmailLogin() {
try {
console.log("Email login button clicked");
const email = getElement("email").value.trim();
const password = getElement("password").value.trim();

if (!validateEmail(email) || !validatePassword(password)) {
    console.log("Validation failed");
    return;
}

showLoading();

auth.signInWithEmailAndPassword(email, password)
    .then(function(userCredential) {
        // User signed in successfully
        console.log("User signed in:", userCredential.user.email);
    })
    .catch(function(error) {
        // Handle errors
        console.error("Login error:", error);
        hideLoading();
        getElement("emailLoginMessage").textContent = error.message;
        setTimeout(function() {
            getElement("emailLoginMessage").textContent = "";
        }, 5000);
    });
} catch (error) {
console.error("Error in email login:", error);
hideLoading();
}
}

function handleEmailSignup() {
try {
console.log("Email signup button clicked");
const email = getElement("email").value.trim();
const password = getElement("password").value.trim();

if (!validateEmail(email) || !validatePassword(password)) {
    console.log("Validation failed");
    return;
}

showLoading();

auth.createUserWithEmailAndPassword(email, password)
    .then(function(userCredential) {
        // User created successfully
        console.log("User created:", userCredential.user.email);
    })
    .catch(function(error) {
        // Handle errors
        console.error("Signup error:", error);
        hideLoading();
        getElement("emailLoginMessage").textContent = error.message;
        setTimeout(function() {
            getElement("emailLoginMessage").textContent = "";
        }, 5000);
    });
} catch (error) {
console.error("Error in email signup:", error);
hideLoading();
}
}

function handleGoogleLogin() {
try {
console.log("Google login button clicked");
showLoading();

const provider = new firebase.auth.GoogleAuthProvider();

auth.signInWithPopup(provider)
    .then(function(result) {
        // User signed in with Google
        console.log("User signed in with Google:", result.user.email);
    })
    .catch(function(error) {
        // Handle errors
        console.error("Google login error:", error);
        hideLoading();
        getElement("emailLoginMessage").textContent = error.message;
        setTimeout(function() {
            getElement("emailLoginMessage").textContent = "";
        }, 5000);
    });
} catch (error) {
console.error("Error in Google login:", error);
hideLoading();
}
}

function handleLogout() {
try {
console.log("Logout button clicked");
showLoading();

auth.signOut()
    .then(function() {
        // User signed out successfully
        console.log("User signed out");
        currentUser = null;
        isAdmin = false;
        
        // Clear form fields
        getElement("email").value = "";
        getElement("password").value = "";
        getElement("emailLoginMessage").textContent = "";
        
        // Reset validation states
        getElement("emailFormGroup").classList.remove("error", "success");
        getElement("passwordFormGroup").classList.remove("error", "success");
        
        // Show login container
        getElement("loginContainer").style.display = "flex";
        getElement("mainContent").style.display = "none";
        
        hideLoading();
    })
    .catch(function(error) {
        // Handle errors
        console.error("Logout error:", error);
        hideLoading();
    });
} catch (error) {
console.error("Error in logout:", error);
hideLoading();
}
}

// Form validation
function setupValidation() {
try {
getElement("email").addEventListener("input", function() {
    validateEmail(this.value);
});

getElement("password").addEventListener("input", function() {
    validatePassword(this.value);
});
} catch (error) {
console.error("Error setting up validation:", error);
}
}

function validateEmail(email) {
const emailFormGroup = getElement("emailFormGroup");
const emailError = getElement("emailError");
const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

if (email.trim() === "") {
setInvalid(emailFormGroup, emailError, "Email cannot be empty");
return false;
} else if (!emailRegex.test(email)) {
setInvalid(emailFormGroup, emailError, "Please enter a valid email address");
return false;
} else {
setValid(emailFormGroup);
return true;
}
}

function validatePassword(password) {
const passwordFormGroup = getElement("passwordFormGroup");
const passwordError = getElement("passwordError");

if (password.trim() === "") {
setInvalid(passwordFormGroup, passwordError, "Password cannot be empty");
return false;
} else if (password.length < 6) {
setInvalid(passwordFormGroup, passwordError, "Password must be at least 6 characters");
return false;
} else {
setValid(passwordFormGroup);
return true;
}
}

function setInvalid(formGroup, errorElement, message) {
formGroup.classList.add("error");
formGroup.classList.remove("success");
errorElement.textContent = message;
}

function setValid(formGroup) {
formGroup.classList.remove("error");
formGroup.classList.add("success");
}

// Toggle dark mode
function toggleDarkMode() {
darkModeEnabled = !darkModeEnabled;
document.body.classList.toggle("dark-mode");

// Update icon
getElement("darkModeToggle").innerHTML = darkModeEnabled ? 
'<i class="fas fa-sun"></i>' : 
'<i class="fas fa-moon"></i>';

// Save to Firestore if user is logged in
if (currentUser) {
db.collection("users").doc(currentUser.uid).update({
    darkMode: darkModeEnabled
}).catch(function(error) {
    console.error("Error saving dark mode preference:", error);
});
}
}

// Toggle mobile navigation
function toggleMobileNav() {
const navMenu = getElement("navMenu");
navMenu.classList.toggle("active");

getElement("mobileNavToggle").innerHTML = navMenu.classList.contains("active") ? 
'<i class="fas fa-times"></i>' : 
'<i class="fas fa-bars"></i>';
}

// Setup navigation links
function setupNavLinks() {
document.querySelectorAll("nav a").forEach(link => {
link.addEventListener("click", function(e) {
    e.preventDefault();
    
    // Close mobile menu if open
    const navMenu = getElement("navMenu");
    if (navMenu.classList.contains("active")) {
        navMenu.classList.remove("active");
        getElement("mobileNavToggle").innerHTML = '<i class="fas fa-bars"></i>';
    }
    
    const targetId = this.getAttribute("href");
    const targetElement = getElement(targetId.substring(1));
    
    window.scrollTo({
        top: targetElement.offsetTop - 80,
        behavior: "smooth"
    });
});
});
}

// Setup lightbox controls
function setupLightboxControls() {
try {
getElement("lightboxClose").addEventListener("click", closeLightbox);
getElement("lightboxPrev").addEventListener("click", showPrevImage);
getElement("lightboxNext").addEventListener("click", showNextImage);

// Close lightbox on Escape key
document.addEventListener("keydown", function(e) {
    if (e.key === "Escape" && getElement("lightbox").style.display === "flex") {
        closeLightbox();
    }
});
} catch (error) {
console.error("Error setting up lightbox controls:", error);
}
}

// Setup file upload
function setupFileUpload() {
try {
getElement("profilePicUpload").addEventListener("change", function() {
    if (this.files && this.files[0]) {
        getElement("profilePicFileName").textContent = this.files[0].name;
        
        // Read the file and convert to data URL for preview
        const reader = new FileReader();
        reader.onload = function(e) {
            getElement("editProfilePic").value = e.target.result;
        };
        reader.readAsDataURL(this.files[0]);
    }
});
} catch (error) {
console.error("Error setting up file upload:", error);
}
}

// Setup edit buttons
function setupEditButtons() {
try {
// Header edit
getElement("editHeader").addEventListener("click", function() {
    getElement("editTagline").value = websiteContent.header.tagline;
    getElement("editProfilePic").value = websiteContent.header.profilePic;
    getElement("profilePicFileName").textContent = "No file chosen";
    getElement("headerEditModal").style.display = "flex";
});

getElement("saveHeaderBtn").addEventListener("click", function() {
    showLoading();
    websiteContent.header.tagline = getElement("editTagline").value;
    
    // Check if profile pic is a data URL (uploaded file)
    const profilePicValue = getElement("editProfilePic").value;
    if (profilePicValue.startsWith("data:")) {
        // Upload to Firebase Storage
        uploadImageToStorage(profilePicValue, "profile-pic").then(url => {
            websiteContent.header.profilePic = url;
            saveAndSyncChanges();
            getElement("headerEditModal").style.display = "none";
            hideLoading();
        }).catch(error => {
            console.error("Error uploading profile pic:", error);
            hideLoading();
        });
    } else {
        // Just a URL, save directly
        websiteContent.header.profilePic = profilePicValue;
        saveAndSyncChanges();
        getElement("headerEditModal").style.display = "none";
        hideLoading();
    }
});

getElement("cancelHeaderBtn").addEventListener("click", function() {
    getElement("headerEditModal").style.display = "none";
});

// About edit
getElement("editAbout").addEventListener("click", function() {
    getElement("editAboutContent").value = stripTags(websiteContent.about);
    getElement("aboutEditModal").style.display = "flex";
});

getElement("saveAboutBtn").addEventListener("click", function() {
    websiteContent.about = formatParagraphs(getElement("editAboutContent").value);
    saveAndSyncChanges();
    getElement("aboutEditModal").style.display = "none";
});

getElement("cancelAboutBtn").addEventListener("click", function() {
    getElement("aboutEditModal").style.display = "none";
});

// Interests edit
getElement("editInterests").addEventListener("click", function() {
    renderInterestsEditList();
    getElement("interestsEditModal").style.display = "flex";
});

getElement("addInterestBtn").addEventListener("click", function() {
    addInterestItem("");
});

getElement("saveInterestsBtn").addEventListener("click", function() {
    const interests = [];
    document.querySelectorAll(".interest-item input").forEach(input => {
        if (input.value.trim()) interests.push(input.value.trim());
    });
    
    websiteContent.interests = interests;
    saveAndSyncChanges();
    getElement("interestsEditModal").style.display = "none";
});

getElement("cancelInterestsBtn").addEventListener("click", function() {
    getElement("interestsEditModal").style.display = "none";
});

// Gallery edit
getElement("editGallery").addEventListener("click", function() {
    renderGalleryEditItems();
    getElement("galleryEditModal").style.display = "flex";
});

getElement("addGalleryItemBtn").addEventListener("click", function() {
    addGalleryItem({url: "", caption: ""});
});

getElement("saveGalleryBtn").addEventListener("click", async function() {
    showLoading();
    
    // Get all gallery items
    const galleryItems = document.querySelectorAll(".gallery-edit-item");
    const newGallery = [];
    
    // Process each gallery item
    for (let i = 0; i < galleryItems.length; i++) {
        const item = galleryItems[i];
        const urlInput = item.querySelector(".gallery-url-input");
        const captionInput = item.querySelector(".gallery-caption-input");
        
        if (urlInput.value.trim()) {
            if (urlInput.value.startsWith("data:")) {
                // It's a data URL, upload to Firebase Storage
                try {
                    const url = await uploadImageToStorage(urlInput.value, `gallery-${Date.now()}-${i}`);
                    newGallery.push({
                        url: url,
                        caption: captionInput.value.trim()
                    });
                } catch (error) {
                    console.error("Error uploading gallery image:", error);
                }
            } else {
                // It's a regular URL
                newGallery.push({
                    url: urlInput.value.trim(),
                    caption: captionInput.value.trim()
                });
            }
        } else {
            // Empty URL, just add placeholder
            newGallery.push({
                url: "",
                caption: captionInput.value.trim()
            });
        }
    }
    
    // Update website content
    websiteContent.gallery = newGallery;
    saveAndSyncChanges();
    getElement("galleryEditModal").style.display = "none";
    hideLoading();
});

getElement("cancelGalleryBtn").addEventListener("click", function() {
    getElement("galleryEditModal").style.display = "none";
});

// Contact edit
getElement("editContact").addEventListener("click", function() {
    getElement("editEmail").value = websiteContent.contact.email;
    getElement("editPhone").value = websiteContent.contact.phone;
    getElement("editInstagram").value = websiteContent.contact.instagram;
    getElement("editLinkedIn").value = websiteContent.contact.linkedin;
    getElement("contactEditModal").style.display = "flex";
});

getElement("saveContactBtn").addEventListener("click", function() {
    websiteContent.contact = {
        email: getElement("editEmail").value.trim(),
        phone: getElement("editPhone").value.trim(),
        instagram: getElement("editInstagram").value.trim(),
        linkedin: getElement("editLinkedIn").value.trim()
    };
    
    saveAndSyncChanges();
    getElement("contactEditModal").style.display = "none";
});

getElement("cancelContactBtn").addEventListener("click", function() {
    getElement("contactEditModal").style.display = "none";
});

// Handle ESC key for closing modals
document.addEventListener("keydown", function(e) {
    if (e.key === "Escape") {
        document.querySelectorAll(".edit-modal").forEach(modal => {
            if (modal.style.display === "flex") {
                modal.style.display = "none";
            }
        });
    }
});
} catch (error) {
console.error("Error setting up edit buttons:", error);
}
}

// Upload image to Firebase Storage
async function uploadImageToStorage(dataUrl, filename) {
try {
// Convert data URL to blob
const blob = await dataURLtoBlob(dataUrl);

// Create storage reference
const storageRef = storage.ref();
const imageRef = storageRef.child(`images/${currentUser.uid}/${filename}`);

// Upload the blob
const snapshot = await imageRef.put(blob);

// Get the download URL
const url = await snapshot.ref.getDownloadURL();

return url;
} catch (error) {
console.error("Error uploading image:", error);
throw error;
}
}

// Convert data URL to blob
function dataURLtoBlob(dataUrl) {
return new Promise((resolve, reject) => {
try {
    const arr = dataUrl.split(',');
    const mime = arr[0].match(/:(.*?);/)[1];
    const bstr = atob(arr[1]);
    let n = bstr.length;
    const u8arr = new Uint8Array(n);
    
    while (n--) {
        u8arr[n] = bstr.charCodeAt(n);
    }
    
    resolve(new Blob([u8arr], { type: mime }));
} catch (error) {
    reject(error);
}
});
}

// Load content from Firestore
async function loadContent() {
try {
console.log("Loading content from Firestore...");

if (!currentUser) {
    console.warn("No user signed in, using default content");
    websiteContent = { ...defaultWebsiteContent };
    return;
}

// Try to load user preferences
const userDoc = await db.collection("users").doc(currentUser.uid).get();
if (userDoc.exists) {
    // Load dark mode preference if available
    if (userDoc.data().darkMode !== undefined) {
        darkModeEnabled = userDoc.data().darkMode;
        if (darkModeEnabled) {
            document.body.classList.add("dark-mode");
            getElement("darkModeToggle").innerHTML = '<i class="fas fa-sun"></i>';
        }
    }
}

// Try to load website content
const contentDoc = await db.collection("websiteContent").doc(currentUser.uid).get();

if (contentDoc.exists) {
    // Found website content for this user
    websiteContent = contentDoc.data();
    console.log("Content loaded from Firestore");
} else {
    // No website content found, use default
    websiteContent = { ...defaultWebsiteContent };
    console.log("No content found, using default");
    
    // Save default content to Firestore
    await db.collection("websiteContent").doc(currentUser.uid).set(websiteContent);
    console.log("Default content saved to Firestore");
}
} catch (error) {
console.error("Error loading content:", error);
// Fall back to default content
websiteContent = { ...defaultWebsiteContent };
}
}

// Save content to Firestore
async function saveContent() {
try {
if (!currentUser) {
    console.warn("No user signed in, can't save content");
    return;
}

// Save to Firestore
await db.collection("websiteContent").doc(currentUser.uid).set(websiteContent);
console.log("Content saved to Firestore");
return true;
} catch (error) {
console.error("Error saving content:", error);
return false;
}
}

// Function to save and sync all changes
async function saveAndSyncChanges() {
// Save content to Firestore
const saved = await saveContent();

// Render updates to the page
renderContent();

// Show a brief notification to the user
if (saved) {
showSaveNotification();
}
}

// Function to show a save notification
function showSaveNotification() {
const notification = getElement("saveNotification");
notification.classList.add("show");

// Hide after 3 seconds
setTimeout(function() {
notification.classList.remove("show");
}, 3000);
}

// Setup scroll animations
function setupScrollEvents() {
try {
// Sticky navigation
const nav = document.querySelector("nav");
const navTop = nav.offsetTop;

window.addEventListener("scroll", function() {
    if (window.scrollY >= navTop) {
        nav.classList.add("scrolled");
    } else {
        nav.classList.remove("scrolled");
    }
    
    // Animate sections on scroll
    document.querySelectorAll("section").forEach(section => {
        const sectionTop = section.getBoundingClientRect().top;
        const windowHeight = window.innerHeight;
        
        if (sectionTop < windowHeight * 0.75) {
            section.classList.add("visible");
        }
    });
});

// Trigger initial scroll event to set initial states
window.dispatchEvent(new Event("scroll"));
} catch (error) {
console.error("Error setting up scroll events:", error);
}
}

// Rendering functions
function renderInterestsEditList() {
const list = getElement("interestsEditList");
list.innerHTML = "";
websiteContent.interests.forEach(interest => addInterestItem(interest));
}

function addInterestItem(interest) {
const list = getElement("interestsEditList");
const item = document.createElement("div");
item.className = "interest-item";
item.style.display = "flex";
item.style.marginBottom = "15px";

const input = document.createElement("input");
input.type = "text";
input.value = interest;
input.placeholder = "Enter interest";
input.style.flexGrow = "1";

const removeBtn = document.createElement("button");
removeBtn.innerHTML = '<i class="fas fa-trash"></i>';
removeBtn.style.marginLeft = "10px";
removeBtn.style.width = "40px";
removeBtn.style.height = "40px";
removeBtn.style.background = "#e74c3c";
removeBtn.style.color = "white";
removeBtn.style.border = "none";
removeBtn.style.borderRadius = "4px";
removeBtn.style.cursor = "pointer";
removeBtn.addEventListener("click", function() {
item.style.animation = "fadeOut 0.3s ease";
setTimeout(function() {
    item.remove();
}, 300);
});

item.appendChild(input);
item.appendChild(removeBtn);
list.appendChild(item);
}

function renderGalleryEditItems() {
const container = getElement("galleryEditItems");
container.innerHTML = "";
container.style.display = "grid";
container.style.gridTemplateColumns = "repeat(auto-fill, minmax(200px, 1fr))";
container.style.gap = "20px";
container.style.marginTop = "20px";

websiteContent.gallery.forEach((item, index) => {
addGalleryItem(item, index);
});
}

function addGalleryItem(item = {url: "", caption: ""}, index = null) {
const container = getElement("galleryEditItems");

const galleryItem = document.createElement("div");
galleryItem.className = "gallery-edit-item";
galleryItem.style.position = "relative";
galleryItem.style.backgroundColor = "var(--background)";
galleryItem.style.borderRadius = "8px";
galleryItem.style.padding = "15px";
galleryItem.style.boxShadow = "0 2px 8px rgba(0, 0, 0, 0.1)";

// Image preview area
const previewArea = document.createElement("div");
previewArea.style.width = "100%";
previewArea.style.height = "120px";
previewArea.style.backgroundColor = "#eee";
previewArea.style.borderRadius = "5px";
previewArea.style.marginBottom = "10px";
previewArea.style.overflow = "hidden";
previewArea.style.display = "flex";
previewArea.style.alignItems = "center";
previewArea.style.justifyContent = "center";

if (item.url) {
const img = document.createElement("img");
img.src = item.url;
img.alt = item.caption || "Gallery image";
img.style.width = "100%";
img.style.height = "100%";
img.style.objectFit = "cover";
previewArea.appendChild(img);
} else {
previewArea.innerHTML = '<i class="fas fa-image" style="font-size: 30px; color: #ccc;"></i>';
}

// URL input
const urlLabel = document.createElement("label");
urlLabel.textContent = "Image URL:";
urlLabel.style.display = "block";
urlLabel.style.marginBottom = "5px";
urlLabel.style.fontSize = "14px";

const urlInput = document.createElement("input");
urlInput.type = "text";
urlInput.className = "gallery-url-input";
urlInput.value = item.url || "";
urlInput.placeholder = "Enter image URL";
urlInput.style.width = "100%";
urlInput.style.marginBottom = "10px";

// Preview image when URL changes
urlInput.addEventListener("change", function() {
if (urlInput.value) {
    previewArea.innerHTML = "";
    const img = document.createElement("img");
    img.src = urlInput.value;
    img.alt = "Gallery preview";
    img.style.width = "100%";
    img.style.height = "100%";
    img.style.objectFit = "cover";
    previewArea.appendChild(img);
} else {
    previewArea.innerHTML = '<i class="fas fa-image" style="font-size: 30px; color: #ccc;"></i>';
}
});

// Caption input
const captionLabel = document.createElement("label");
captionLabel.textContent = "Caption:";
captionLabel.style.display = "block";
captionLabel.style.marginBottom = "5px";
captionLabel.style.fontSize = "14px";

const captionInput = document.createElement("input");
captionInput.type = "text";
captionInput.className = "gallery-caption-input";
captionInput.value = item.caption || "";
captionInput.placeholder = "Enter caption";
captionInput.style.width = "100%";

// File upload option
const fileInputLabel = document.createElement("label");
fileInputLabel.textContent = "Or upload image:";
fileInputLabel.style.display = "block";
fileInputLabel.style.marginTop = "10px";
fileInputLabel.style.marginBottom = "5px";
fileInputLabel.style.fontSize = "14px";

const fileInputContainer = document.createElement("div");
fileInputContainer.className = "file-input-container";
fileInputContainer.style.marginBottom = "10px";

const fileInputBtn = document.createElement("label");
fileInputBtn.className = "file-input-label";
fileInputBtn.innerHTML = '<i class="fas fa-upload"></i> Choose Image';
fileInputBtn.style.display = "block";
fileInputBtn.style.padding = "8px";
fileInputBtn.style.backgroundColor = "#f0f0f0";
fileInputBtn.style.color = "var(--text)";
fileInputBtn.style.borderRadius = "4px";
fileInputBtn.style.cursor = "pointer";
fileInputBtn.style.textAlign = "center";
fileInputBtn.style.transition = "all 0.3s ease";

const fileInput = document.createElement("input");
fileInput.type = "file";
fileInput.accept = "image/*";
fileInput.className = "file-input";
fileInput.style.position = "absolute";
fileInput.style.left = "0";
fileInput.style.top = "0";
fileInput.style.opacity = "0";
fileInput.style.width = "100%";
fileInput.style.height = "100%";
fileInput.style.cursor = "pointer";

fileInput.addEventListener("change", function() {
if (this.files && this.files[0]) {
    const reader = new FileReader();
    reader.onload = function(e) {
        urlInput.value = e.target.result;
        
        // Update preview
        previewArea.innerHTML = "";
        const img = document.createElement("img");
        img.src = e.target.result;
        img.alt = "Gallery preview";
        img.style.width = "100%";
        img.style.height = "100%";
        img.style.objectFit = "cover";
        previewArea.appendChild(img);
    };
    reader.readAsDataURL(this.files[0]);
}
});

fileInputBtn.appendChild(fileInput);
fileInputContainer.appendChild(fileInputBtn);

// Remove button
const removeBtn = document.createElement("button");
removeBtn.innerHTML = '<i class="fas fa-times"></i>';
removeBtn.style.position = "absolute";
removeBtn.style.top = "10px";
removeBtn.style.right = "10px";
removeBtn.style.width = "30px";
removeBtn.style.height = "30px";
removeBtn.style.background = "#e74c3c";
removeBtn.style.color = "white";
removeBtn.style.border = "none";
removeBtn.style.borderRadius = "50%";
removeBtn.style.cursor = "pointer";
removeBtn.style.display = "flex";
removeBtn.style.alignItems = "center";
removeBtn.style.justifyContent = "center";
removeBtn.addEventListener("click", function() {
galleryItem.style.animation = "fadeOut 0.3s ease";
setTimeout(function() {
    galleryItem.remove();
}, 300);
});

// Append all elements
galleryItem.appendChild(previewArea);
galleryItem.appendChild(urlLabel);
galleryItem.appendChild(urlInput);
galleryItem.appendChild(captionLabel);
galleryItem.appendChild(captionInput);
galleryItem.appendChild(fileInputLabel);
galleryItem.appendChild(fileInputContainer);
galleryItem.appendChild(removeBtn);

container.appendChild(galleryItem);
}

// Render website content
function renderContent() {
try {
if (!websiteContent) {
    console.error("No website content available to render");
    return;
}

// Header
getElement("tagline").textContent = websiteContent.header.tagline;
getElement("profilePic").src = websiteContent.header.profilePic;

// About
getElement("aboutContent").innerHTML = websiteContent.about;

// Interests
const interestsList = getElement("interestsList");
interestsList.innerHTML = "";
websiteContent.interests.forEach(interest => {
    const li = document.createElement("li");
    li.textContent = interest;
    interestsList.appendChild(li);
});

// Gallery
const galleryItems = getElement("galleryItems");
galleryItems.innerHTML = "";
websiteContent.gallery.forEach((item, index) => {
    if (!item.url) return; // Skip items without images
    
    const galleryItem = document.createElement("div");
    galleryItem.className = "gallery-item";
    
    // Create image element
    const img = document.createElement("img");
    img.src = item.url;
    img.alt = item.caption || "Gallery image";
    galleryItem.appendChild(img);
    
    // Add caption if available
    if (item.caption) {
        const caption = document.createElement("div");
        caption.className = "caption";
        caption.textContent = item.caption;
        galleryItem.appendChild(caption);
    }
    
    // Open lightbox on click
    galleryItem.addEventListener("click", function() {
        openLightbox(index);
    });
    
    galleryItems.appendChild(galleryItem);
});

// Contact
const contactLinks = getElement("contactLinks");
contactLinks.innerHTML = "";

if (websiteContent.contact.email) {
    addContactLink(contactLinks, `mailto:${websiteContent.contact.email}`, '<i class="fas fa-envelope"></i> Email');
}

if (websiteContent.contact.phone) {
    addContactLink(contactLinks, `tel:${websiteContent.contact.phone}`, '<i class="fas fa-phone"></i> Phone');
}

if (websiteContent.contact.instagram) {
    addContactLink(contactLinks, websiteContent.contact.instagram, '<i class="fab fa-instagram"></i> Instagram', true);
}

if (websiteContent.contact.linkedin) {
    addContactLink(contactLinks, websiteContent.contact.linkedin, '<i class="fab fa-linkedin"></i> LinkedIn', true);
}
} catch (error) {
console.error("Error rendering content:", error);
}
}

function addContactLink(container, href, html, newTab) {
const link = document.createElement("a");
link.href = href;
link.innerHTML = html;
if (newTab) link.target = "_blank";
container.appendChild(link);
}

// Lightbox functionality
function openLightbox(index) {
try {
currentGalleryIndex = index;
const gallery = websiteContent.gallery;

// If there are no images or the URL is empty, don't open lightbox
if (!gallery[index] || !gallery[index].url) return;

getElement("lightboxImage").src = gallery[index].url;
getElement("lightboxCaption").textContent = gallery[index].caption || "";
getElement("lightbox").style.display = "flex";

// Disable scrolling on body while lightbox is open
document.body.style.overflow = "hidden";
} catch (error) {
console.error("Error opening lightbox:", error);
}
}

function closeLightbox() {
try {
getElement("lightbox").style.display = "none";

// Re-enable scrolling
document.body.style.overflow = "";
} catch (error) {
console.error("Error closing lightbox:", error);
}
}

function showPrevImage() {
try {
const gallery = websiteContent.gallery;
currentGalleryIndex = (currentGalleryIndex - 1 + gallery.length) % gallery.length;

// Skip empty URLs
while (!gallery[currentGalleryIndex].url && currentGalleryIndex !== (currentGalleryIndex + 1) % gallery.length) {
    currentGalleryIndex = (currentGalleryIndex - 1 + gallery.length) % gallery.length;
}

getElement("lightboxImage").src = gallery[currentGalleryIndex].url;
getElement("lightboxCaption").textContent = gallery[currentGalleryIndex].caption || "";
} catch (error) {
console.error("Error showing previous image:", error);
}
}

function showNextImage() {
try {
const gallery = websiteContent.gallery;
currentGalleryIndex = (currentGalleryIndex + 1) % gallery.length;

// Skip empty URLs
while (!gallery[currentGalleryIndex].url && currentGalleryIndex !== (currentGalleryIndex - 1 + gallery.length) % gallery.length) {
    currentGalleryIndex = (currentGalleryIndex + 1) % gallery.length;
}

getElement("lightboxImage").src = gallery[currentGalleryIndex].url;
getElement("lightboxCaption").textContent = gallery[currentGalleryIndex].caption || "";
} catch (error) {
console.error("Error showing next image:", error);
}
}

// Helper functions
function stripTags(html) {
const temp = document.createElement("div");
temp.innerHTML = html;
return temp.textContent || temp.innerText || "";
}

function formatParagraphs(text) {
return text.split("\n")
.filter(p => p.trim() !== "")
.map(p => `<p>${p}</p>`)
.join("");
}

// Hide loading overlay when page is loaded
window.addEventListener("load", function() {
setTimeout(function() {
if (getElement("loadingOverlay").style.display === "flex") {
    hideLoading();
}
}, 3000); // Fallback timeout after 3 seconds
});
</script>
</body>
</html><!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Charvi's Website</title>
<!-- Firebase SDK -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.20.0/firebase-app-compat.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.20.0/firebase-firestore-compat.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.20.0/firebase-auth-compat.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.20.0/firebase-storage-compat.min.js"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
<!-- Same styles as before -->
<style>
/* Base Styles with Modern Color Scheme */
:root {
--primary: #7F5AF0;
--primary-light: #9E7CF4;
--secondary: #2CB67D;
--accent: #FF8E3C;
--background: #F9F9FB;
--card-bg: #FFFFFF;
--text: #2B2C34;
--text-light: #72757E;

/* Dark mode variables */
--dark-background: #16161A;
--dark-card-bg: #242629;
--dark-text: #FFFFFE;
--dark-text-light: #94A1B2;
}

* {margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;}

body {
background-color: var(--background);
color: var(--text);
line-height: 1.6;
transition: all 0.3s ease;
}

.container {
max-width: 1200px;
margin: 0 auto;
padding: 20px;
}

header {
background: linear-gradient(135deg, var(--primary), var(--primary-light));
color: white;
text-align: center;
padding: 40px 20px;
border-radius: 10px;
margin-bottom: 30px;
box-shadow: 0 8px 20px rgba(127, 90, 240, 0.2);
position: relative;
overflow: hidden;
}

header::before {
content: "";
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: linear-gradient(45deg, transparent 40%, rgba(255, 255, 255, 0.1) 45%, transparent 50%);
animation: shine 5s infinite linear;
}

@keyframes shine {
0% {
transform: translateX(-100%);
}
100% {
transform: translateX(100%);
}
}

h1 {
font-size: 2.8em;
margin-bottom: 10px;
position: relative;
z-index: 1;
}

.tagline {
font-size: 1.3em;
font-style: italic;
margin-bottom: 20px;
position: relative;
z-index: 1;
}

.profile-pic {
width: 150px;
height: 150px;
border-radius: 50%;
object-fit: cover;
border: 5px solid white;
margin: 0 auto 20px;
display: block;
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
transition: transform 0.5s ease, box-shadow 0.3s ease;
position: relative;
z-index: 1;
background-color: #ddd;
}

.profile-pic:hover {
transform: scale(1.05);
box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

/* Modern Navigation */
nav {
background-color: var(--card-bg);
border-radius: 8px;
padding: 15px;
margin-bottom: 30px;
box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
position: sticky;
top: 15px;
z-index: 100;
transition: all 0.3s ease;
}

nav.scrolled {
padding: 10px 15px;
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

nav ul {
list-style: none;
display: flex;
justify-content: center;
}

nav ul li {
margin: 0 15px;
}

nav ul li a {
text-decoration: none;
color: var(--text);
font-weight: 600;
transition: color 0.3s;
position: relative;
padding-bottom: 5px;
}

nav ul li a::after {
content: '';
position: absolute;
width: 0;
height: 2px;
bottom: 0;
left: 0;
background-color: var(--primary);
transition: width 0.3s ease;
}

nav ul li a:hover {
color: var(--primary);
}

nav ul li a:hover::after {
width: 100%;
}

/* Mobile Navigation */
.mobile-nav-toggle {
display: none;
background: none;
border: none;
font-size: 24px;
color: var(--text);
cursor: pointer;
}

/* Content Sections */
section {
background-color: var(--card-bg);
border-radius: 8px;
padding: 30px;
margin-bottom: 30px;
box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
position: relative;
transition: transform 0.3s ease, box-shadow 0.3s ease;
opacity: 0;
transform: translateY(20px);
}

section.visible {
opacity: 1;
transform: translateY(0);
}

section:hover {
transform: translateY(-5px);
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

h2 {
color: var(--primary);
margin-bottom: 20px;
border-bottom: 2px solid var(--background);
padding-bottom: 10px;
position: relative;
}

h2::after {
content: '';
position: absolute;
bottom: -2px;
left: 0;
width: 50px;
height: 2px;
background-color: var(--primary);
transition: width 0.3s ease;
}

section:hover h2::after {
width: 100px;
}

/* Special styling for login form heading */
.login-form h2 {
border-bottom: none;
text-align: center;
margin-bottom: 25px;
}

.login-form h2::after {
display: none;
}

/* Enhanced Gallery */
.gallery {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
gap: 20px;
margin-top: 20px;
}

.gallery-item {
height: 200px;
background-color: #eee;
border-radius: 8px;
overflow: hidden;
transition: transform 0.3s ease, box-shadow 0.3s ease;
cursor: pointer;
position: relative;
}

.gallery-item:hover {
transform: scale(1.03);
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
}

.gallery-item img {
width: 100%;
height: 100%;
object-fit: cover;
transition: transform 0.5s ease;
}

.gallery-item:hover img {
transform: scale(1.1);
}

.gallery-item .caption {
position: absolute;
bottom: 0;
left: 0;
right: 0;
padding: 10px;
background: rgba(0, 0, 0, 0.7);
color: white;
transform: translateY(100%);
transition: transform 0.3s ease;
}

.gallery-item:hover .caption {
transform: translateY(0);
}

/* Lightbox */
.lightbox {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background-color: rgba(0, 0, 0, 0.9);
display: none;
justify-content: center;
align-items: center;
z-index: 2000;
padding: 30px;
}

.lightbox-content {
position: relative;
max-width: 90%;
max-height: 80vh;
}

.lightbox img {
max-width: 100%;
max-height: 80vh;
border-radius: 5px;
object-fit: contain;
}

.lightbox-close {
position: absolute;
top: 20px;
right: 20px;
color: white;
font-size: 30px;
cursor: pointer;
z-index: 2001;
}

.lightbox-nav {
position: absolute;
top: 50%;
width: 100%;
display: flex;
justify-content: space-between;
padding: 0 20px;
transform: translateY(-50%);
}

.lightbox-prev, .lightbox-next {
color: white;
font-size: 30px;
cursor: pointer;
background: rgba(0, 0, 0, 0.5);
width: 50px;
height: 50px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
transition: background 0.3s ease;
}

.lightbox-prev:hover, .lightbox-next:hover {
background: rgba(0, 0, 0, 0.8);
}

.lightbox-caption {
position: absolute;
bottom: -40px;
left: 0;
right: 0;
text-align: center;
color: white;
font-size: 16px;
}

/* Footer */
footer {
text-align: center;
padding: 30px 0;
color: var(--text-light);
font-size: 0.9em;
position: relative;
}

.social-links {
display: flex;
justify-content: center;
flex-wrap: wrap;
gap: 15px;
margin-top: 20px;
}

.social-links a {
display: inline-flex;
align-items: center;
justify-content: center;
padding: 10px 20px;
background-color: var(--primary);
color: white;
border-radius: 5px;
text-decoration: none;
font-weight: 600;
transition: all 0.3s ease;
}

.social-links a i {
margin-right: 8px;
}

.social-links a:hover {
transform: translateY(-3px);
background-color: var(--primary-light);
box-shadow: 0 5px 15px rgba(127, 90, 240, 0.3);
}

/* Theme Switch */
.theme-switch {
position: fixed;
top: 20px;
right: 20px;
z-index: 100;
}

.theme-switch button {
background-color: rgba(0, 0, 0, 0.1);
border: none;
border-radius: 50%;
width: 40px;
height: 40px;
cursor: pointer;
display: flex;
align-items: center;
justify-content: center;
font-size: 18px;
color: var(--text);
transition: all 0.3s ease;
}

.theme-switch button:hover {
background-color: rgba(0, 0, 0, 0.2);
transform: rotate(30deg);
}

/* Login Form */
.login-container {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background-color: rgba(0, 0, 0, 0.7);
display: flex;
justify-content: center;
align-items: center;
z-index: 1000;
backdrop-filter: blur(5px);
}

.login-form {
background-color: var(--card-bg);
padding: 30px;
border-radius: 10px;
box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3);
width: 350px;
max-width: 90%;
animation: fadeIn 0.5s ease;
}

@keyframes fadeIn {
from { opacity: 0; transform: translateY(-20px); }
to { opacity: 1; transform: translateY(0); }
}

.login-form h2 {
margin-bottom: 20px;
text-align: center;
color: var(--primary);
border-bottom: none;
}

.form-group {
margin-bottom: 20px;
position: relative;
}

.form-group label {
display: block;
margin-bottom: 5px;
font-weight: 600;
color: var(--text);
}

.form-group input {
width: 100%;
padding: 12px 15px;
border: 1px solid #ddd;
border-radius: 5px;
font-size: 16px;
transition: border-color 0.3s ease, box-shadow 0.3s ease;
background-color: var(--card-bg);
color: var(--text);
}

.form-group input:focus {
border-color: var(--primary);
box-shadow: 0 0 0 2px rgba(127, 90, 240, 0.2);
outline: none;
}

.form-group .error {
color: #e74c3c;
font-size: 14px;
margin-top: 5px;
display: none;
}

.form-group.error input {
border-color: #e74c3c;
}

.form-group.error .error {
display: block;
}

.form-group.success input {
border-color: var(--secondary);
}

.form-group .validation-icon {
position: absolute;
right: 10px;
top: 38px;
font-size: 16px;
display: none;
}

.form-group.error .validation-icon.error {
display: block;
color: #e74c3c;
}

.form-group.success .validation-icon.success {
display: block;
color: var(--secondary);
}

.btn {
padding: 12px 20px;
background-color: var(--primary);
color: white;
border: none;
border-radius: 5px;
cursor: pointer;
font-size: 16px;
font-weight: 600;
width: 100%;
transition: all 0.3s ease;
}

.btn:hover {
background-color: var(--primary-light);
transform: translateY(-2px);
box-shadow: 0 5px 15px rgba(127, 90, 240, 0.3);
}

.btn:active {
transform: translateY(0);
box-shadow: none;
}

.separator {
display: flex;
align-items: center;
text-align: center;
margin: 20px 0;
color: var(--text-light);
}

.separator::before, .separator::after {
content: '';
flex: 1;
border-bottom: 1px solid rgba(0,0,0,0.1);
margin: 0 8px;
}

.separator span {
padding: 0 5px;
font-size: 14px;
font-weight: 500;
color: var(--text-light);
}

.github-login {
background-color: #333;
}

.github-login:hover {
background-color: #222;
}

.login-message {
margin-top: 15px;
text-align: center;
color: #e74c3c;
font-size: 14px;
min-height: 20px;
}

/* User Controls */
.user-controls {
display: flex;
justify-content: space-between;
align-items: center;
padding: 15px 20px;
background-color: var(--card-bg);
border-radius: 8px;
margin-bottom: 20px;
box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
animation: fadeIn 0.5s ease;
}

.current-user {
font-weight: 600;
color: var(--primary);
display: flex;
align-items: center;
}

.current-user i {
margin-right: 8px;
}

.admin-badge {
display: inline-block;
background-color: var(--accent);
color: white;
padding: 3px 10px;
border-radius: 20px;
font-size: 12px;
margin-left: 10px;
animation: pulse 2s infinite;
}

@keyframes pulse {
0% { box-shadow: 0 0 0 0 rgba(255, 142, 60, 0.4); }
70% { box-shadow: 0 0 0 10px rgba(255, 142, 60, 0); }
100% { box-shadow: 0 0 0 0 rgba(255, 142, 60, 0); }
}

.logout-btn {
padding: 8px 15px;
background-color: #f0f0f0;
color: var(--text);
border: none;
border-radius: 5px;
cursor: pointer;
transition: all 0.3s ease;
display: flex;
align-items: center;
font-weight: 500;
}

.logout-btn i {
margin-right: 5px;
}

.logout-btn:hover {
background-color: #e0e0e0;
transform: translateY(-2px);
}

/* Admin Panel */
.admin-panel {
background-color: #fff8e1;
border-left: 4px solid var(--accent);
padding: 20px;
margin-bottom: 30px;
border-radius: 8px;
animation: slideInDown 0.5s ease;
position: relative;
}

.admin-panel h3 {
color: var(--accent);
margin-bottom: 10px;
}

/* Edit controls */
.edit-btn {
position: absolute;
top: 10px;
right: 10px;
background-color: var(--accent);
color: white;
border: none;
border-radius: 4px;
padding: 5px 10px;
font-size: 12px;
cursor: pointer;
display: none;
z-index: 10;
transition: all 0.3s ease;
}

.edit-btn:hover {
background-color: #e67e38;
transform: translateY(-2px);
}

.edit-modal {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background-color: rgba(0, 0, 0, 0.7);
display: none;
justify-content: center;
align-items: center;
z-index: 2000;
backdrop-filter: blur(5px);
}

.edit-form {
background-color: var(--card-bg);
padding: 30px;
border-radius: 10px;
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
width: 600px;
max-width: 90%;
max-height: 90vh;
overflow-y: auto;
animation: zoomIn 0.3s ease;
}

@keyframes zoomIn {
from { opacity: 0; transform: scale(0.95); }
to { opacity: 1; transform: scale(1); }
}

.edit-form h3 {
margin-bottom: 20px;
color: var(--primary);
border-bottom: 2px solid var(--background);
padding-bottom: 10px;
}

.edit-form textarea {
width: 100%;
min-height: 150px;
padding: 15px;
border: 1px solid #ddd;
border-radius: 5px;
font-size: 16px;
margin-bottom: 20px;
resize: vertical;
background-color: var(--card-bg);
color: var(--text);
transition: border-color 0.3s ease, box-shadow 0.3s ease;
}

.edit-form textarea:focus {
border-color: var(--primary);
box-shadow: 0 0 0 2px rgba(127, 90, 240, 0.2);
outline: none;
}

.edit-form input {
width: 100%;
padding: 12px 15px;
border: 1px solid #ddd;
border-radius: 5px;
font-size: 16px;
margin-bottom: 15px;
background-color: var(--card-bg);
color: var(--text);
transition: border-color 0.3s ease, box-shadow 0.3s ease;
}

.edit-form input:focus {
border-color: var(--primary);
box-shadow: 0 0 0 2px rgba(127, 90, 240, 0.2);
outline: none;
}

.edit-form .btn-container {
display: flex;
justify-content: space-between;
gap: 15px;
}

.edit-form .file-input-container {
position: relative;
margin-bottom: 20px;
}

.edit-form .file-input-label {
display: block;
padding: 12px 15px;
background-color: #f0f0f0;
color: var(--text);
border-radius: 5px;
cursor: pointer;
text-align: center;
transition: all 0.3s ease;
}

.edit-form .file-input-label:hover {
background-color: #e0e0e0;
}

.edit-form .file-input {
position: absolute;
left: 0;
top: 0;
opacity: 0;
width: 100%;
height: 100%;
cursor: pointer;
}

.edit-form .file-name {
margin-top: 5px;
font-size: 14px;
color: var(--text-light);
}

.cancel-btn {
background-color: #f0f0f0;
color: var(--text);
}

.cancel-btn:hover {
background-color: #e0e0e0;
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

/* Save Notification */
#saveNotification {
position: fixed;
bottom: 20px;
right: 20px;
background-color: var(--secondary);
color: white;
padding: 15px 25px;
border-radius: 5px;
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
opacity: 0;
transform: translateY(20px);
transition: opacity 0.3s ease, transform 0.3s ease;
z-index: 9999;
display: flex;
align-items: center;
}

#saveNotification.show {
opacity: 1;
transform: translateY(0);
}

#saveNotification i {
margin-right: 10px;
font-size: 18px;
}

/* Firebase Auth UI */
.firebase-auth {
margin-top: 20px;
}

/* Loading overlay */
.loading-overlay {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background-color: rgba(0, 0, 0, 0.7);
display: flex;
justify-content: center;
align-items: center;
z-index: 3000;
backdrop-filter: blur(5px);
}

.loading-spinner {
width: 50px;
height: 50px;
border: 5px solid rgba(255, 255, 255, 0.3);
border-radius: 50%;
border-top-color: white;
animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
to { transform: rotate(360deg); }
}

/* Dark mode */
body.dark-mode {
background-color: var(--dark-background);
color: var(--dark-text);
}

body.dark-mode nav, 
body.dark-mode section, 
body.dark-mode .user-controls, 
body.dark-mode .edit-form,
body.dark-mode .login-form {
background-color: var(--dark-card-bg);
}

body.dark-mode h2 {
border-bottom-color: #2a2a40;
}

body.dark-mode nav ul li a {
color: var(--dark-text);
}

body.dark-mode .edit-form input, 
body.dark-mode .edit-form textarea,
body.dark-mode .form-group input {
background-color: var(--dark-background);
border-color: #2a2a40;
color: var(--dark-text);
}

body.dark-mode .cancel-btn,
body.dark-mode .logout-btn {
background-color: #2a2a40;
color: var(--dark-text);
}

body.dark-mode .form-group label,
body.dark-mode .edit-form label {
color: var(--dark-text);
}

body.dark-mode footer {
color: var(--dark-text-light);
}

body.dark-mode .theme-switch button {
color: var(--dark-text);
}

body.dark-mode .admin-panel {
background-color: #2a2c3e;
border-left-color: var(--accent);
}

body.dark-mode .separator::before, 
body.dark-mode .separator::after {
border-bottom-color: rgba(255,255,255,0.1);
}

body.dark-mode .separator span {
color: var(--dark-text-light);
}

/* Animation classes */
.hidden {
display: none;
}

/* Responsive Design */
@media (max-width: 768px) {
header {
    padding: 30px 20px;
}

h1 {
    font-size: 1
}
h1 {
    font-size: 2.2em;
}
.tagline {
    font-size: 1.1em;
}   